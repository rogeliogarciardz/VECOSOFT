function f_draw_map(lon_map,lat_map,lon,lat,data,ptitle,pclim,ppcolor,plabel)

    % NDVI colormap - 256 colors - values 0 to 1 like NASA
    ndvi_map_r = [ (33:80)  80*ones(1,79)  (80:-1:0)  zeros(1,48) ]' /80;  % red
    ndvi_map_g = flipud( ndvi_map_r );                                     % green
    ndvi_map_b = zeros( size( ndvi_map_r ) );                              % blue
    ndvi_colormap = [ ndvi_map_r  ndvi_map_g  ndvi_map_b ];

    elevation_colormap = [
        0	0.400000000000000	0.200000000000000
        0.00295408726083153	0.404330708661417	0.200665750567411
        0.00590817452166306	0.408661417322835	0.201331501134822
        0.00886226178249459	0.412992125984252	0.201997251702233
        0.0118163490433261	0.417322834645669	0.202663002269644
        0.0147704363041576	0.421653543307087	0.203328752837055
        0.0177493258071357	0.425984251968504	0.204005938158137
        0.0207319644862523	0.430314960629921	0.204684851988494
        0.0238040065963622	0.434645669291339	0.205404984116968
        0.0270816765977569	0.438976377952756	0.206219918331109
        0.0303593465991517	0.443307086614173	0.207034852545251
        0.0336370166005464	0.447637795275591	0.207849786759392
        0.0369146866019412	0.451968503937008	0.208664720973533
        0.0402029916790796	0.456299212598425	0.209486057975150
        0.0435425953568639	0.460629921259843	0.210338279010476
        0.0468821990346482	0.464960629921260	0.211190500045802
        0.0503969686658574	0.469291338582677	0.212148178757207
        0.0540255961667929	0.473622047244095	0.213174404958064
        0.0576542236677284	0.477952755905512	0.214200631158920
        0.0612828511686639	0.482283464566929	0.215226857359777
        0.0649114786695994	0.486614173228347	0.216253083560633
        0.0685964522721617	0.490944881889764	0.217322212688957
        0.0723437662424814	0.495275590551181	0.218438808885970
        0.0760910802128010	0.499606299212599	0.219555405082982
        0.0801381074896464	0.503937007874016	0.220900208340993
        0.0842151060971443	0.508267716535433	0.222267832305104
        0.0882921047046422	0.512598425196851	0.223635456269215
        0.0923691033121401	0.516929133858268	0.225003080233326
        0.0964461019196381	0.521259842519685	0.226370704197436
        0.100640847235168	0.525590513067497	0.227842989873638
        0.104869234467278	0.529921172725708	0.229345178896152
        0.109156495053404	0.534251813327116	0.230899698774711
        0.113662428097304	0.538582383146114	0.232648590404296
        0.118168361141203	0.542912952965112	0.234397482033882
        0.122674294185103	0.547243522784110	0.236146373663467
        0.127180227229002	0.551574092603108	0.237895265293052
        0.131703696985095	0.555904606817793	0.239661387532910
        0.136426646842383	0.560234488533414	0.241623507964620
        0.141149596699672	0.564564370249035	0.243585628396330
        0.146014155507919	0.568893802959826	0.245686886005991
        0.151011993328833	0.573222813077837	0.247919096253725
        0.156009831149747	0.577551823195847	0.250151306501459
        0.161007668970661	0.581880833313858	0.252383516749193
        0.166005506791575	0.586209843431868	0.254615726996927
        0.171112205866472	0.590537341559857	0.256964032919314
        0.176393655901709	0.594862412545967	0.259498702951014
        0.181675105936947	0.599187483532077	0.262033372982713
        0.187162819400783	0.603509689694987	0.264788013766388
        0.192696369182085	0.607831259230520	0.267591536939390
        0.198229918963388	0.612152828766052	0.270395060112392
        0.203763468744690	0.616474398301585	0.273198583285394
        0.209297018525993	0.620795967837117	0.276002106458396
        0.215022527220290	0.625109717829576	0.279024943260561
        0.220835546595511	0.629419903030341	0.282147761276020
        0.226669536272152	0.633729233995307	0.285294537923237
        0.232655560634085	0.638032371750738	0.288615014650693
        0.238641584996018	0.642335509506170	0.291935491378150
        0.244627609357951	0.646638647261601	0.295255968105607
        0.250613633719884	0.650941785017032	0.298576444833064
        0.256599658081816	0.655244922772463	0.301896921560520
        0.262894451115919	0.659516267429256	0.305593649556292
        0.269192394850757	0.663787287666675	0.309294216850720
        0.275545475848483	0.668052630565052	0.313061971871633
        0.281973385988699	0.672310268503299	0.316920910235633
        0.288401296128915	0.676567906441547	0.320779848599633
        0.294829206269131	0.680825544379794	0.324638786963632
        0.301257116409347	0.685083182318041	0.328497725327632
        0.307765285984241	0.689320536389727	0.332462354989168
        0.314467185229048	0.693508929404195	0.336682101575791
        0.321169084473855	0.697697322418664	0.340901848162414
        0.327922644963973	0.701872659151208	0.345189625929061
        0.334695578421081	0.706043099778030	0.349502915388216
        0.341468511878190	0.710213540404852	0.353816204847371
        0.348241445335299	0.714383981031674	0.358129494306527
        0.355014378792407	0.718554421658496	0.362442783765682
        0.361890644092551	0.722655821054970	0.366909995221116
        0.368836964879498	0.726710412837647	0.371481560572333
        0.375783986221313	0.730764536544186	0.376054169462507
        0.382753425318906	0.734803681814310	0.380660171599332
        0.389722864416498	0.738842827084435	0.385266173736156
        0.396692303514090	0.742881972354559	0.389872175872981
        0.403661742611683	0.746921117624683	0.394478178009806
        0.410631181709275	0.750960262894808	0.399084180146630
        0.417648491720164	0.754798268486637	0.403814158071558
        0.424671180485357	0.758613674114614	0.408558065860318
        0.431694407125979	0.762426819746204	0.413303366635460
        0.438718709517463	0.766235445385024	0.418051453383370
        0.445743011908946	0.770044071023844	0.422799540131279
        0.452761411925531	0.773838699621809	0.427543737568196
        0.459778025697081	0.777629092273199	0.432286757976788
        0.466769787363796	0.781360550015725	0.437013402339099
        0.473663383216412	0.784859214868236	0.441675361318604
        0.480556979069029	0.788357879720747	0.446337320298110
        0.487450574921646	0.791856544573258	0.450999279277615
        0.494344170774262	0.795355209425769	0.455661238257121
        0.501234724749658	0.798849892936360	0.460320123125774
        0.508085299767282	0.802292250238855	0.464938605394658
        0.514935874784906	0.805734607541351	0.469557087663542
        0.521660429174774	0.809012023535720	0.474048213911413
        0.528261483349441	0.812127797048126	0.478414531258691
        0.534862537524108	0.815243570560532	0.482780848605969
        0.541463591698775	0.818359344072938	0.487147165953247
        0.548064645873442	0.821475117585344	0.491513483300525
        0.554616753956100	0.824540446267330	0.495824628744641
        0.561086844262958	0.827521245774020	0.500043323972650
        0.567556934569816	0.830502045280711	0.504262019200658
        0.573683079365258	0.833128367600673	0.508093019974020
        0.579727537101738	0.835670501588787	0.511831943314402
        0.585771994838217	0.838212635576902	0.515570866654785
        0.591816452574697	0.840754769565016	0.519309789995168
        0.597860910311177	0.843296903553130	0.523048713335550
        0.603759386387019	0.845704178600022	0.526614303613434
        0.609588139878675	0.848047043406330	0.530097107951019
        0.615366780262948	0.850343613352218	0.533520409894015
        0.620744515788156	0.852269824414749	0.536467692680296
        0.626122251313363	0.854196035477280	0.539414975466578
        0.631499986838571	0.856122246539811	0.542362258252859
        0.636877722363778	0.858048457602342	0.545309541039140
        0.642255457888986	0.859974668664873	0.548256823825422
        0.647320173257083	0.861624799406160	0.550821679331205
        0.652378434601323	0.863269237769690	0.553378649738421
        0.657247685246866	0.864746970784604	0.555704699401890
        0.661849554904008	0.865988876720989	0.557704080696155
        0.666451424561151	0.867230782657373	0.559703461990421
        0.671053294218293	0.868472688593758	0.561702843284687
        0.675655163875436	0.869714594530143	0.563702224578952
        0.680105522969425	0.870825226229740	0.565512821745175
        0.684171694563991	0.871602983971770	0.566844716301002
        0.688237866158558	0.872380741713799	0.568176610856830
        0.691919850253700	0.872825625498261	0.569029802802263
        0.695450323785690	0.873139235045935	0.569694210619652
        0.698980797317679	0.873452844593609	0.570358618437041
        0.702511270849669	0.873766454141283	0.571023026254431
        0.706041744381659	0.874080063688957	0.571687434071820
        0.709242373910578	0.874106553020901	0.571936969431541
        0.712209837851120	0.873930078062413	0.571893232881531
        0.715169340039863	0.873746672615960	0.571839482168749
        0.717742697266391	0.873227138503159	0.571300044561558
        0.720316054492920	0.872707604390359	0.570760606954367
        0.722889411719448	0.872188070277558	0.570221169347177
        0.725462768945976	0.871668536164758	0.569681731739986
        0.728036126172505	0.871149002051957	0.569142294132796
        0.730002117049776	0.870090180154314	0.567839996247435
        0.731892187133389	0.868963947283566	0.566442340827303
        0.733676628286698	0.867743925232846	0.564912014054446
        0.735239908867178	0.866327532086558	0.563103906636820
        0.736803189447659	0.864911138940270	0.561295799219195
        0.738366470028140	0.863494745793982	0.559487691801569
        0.739929750608621	0.862078352647694	0.557679584383944
        0.741328924787103	0.860510822135021	0.555668470971892
        0.742037124641379	0.858306923763884	0.552802595478045
        0.742745324495656	0.856103025392747	0.549936719984198
        0.743288753549545	0.853747377763053	0.546867016609307
        0.743733851641912	0.851301170091963	0.543675674015084
        0.744178949734279	0.848854962420872	0.540484331420861
        0.744624047826646	0.846408754749782	0.537292988826638
        0.745069145919013	0.843962547078691	0.534101646232415
        0.745137789692519	0.841151504417462	0.530460839577482
        0.744822296405961	0.837968181154049	0.526361396125906
        0.744506803119404	0.834784857890637	0.522261952674330
        0.744069445662068	0.831483431815497	0.518017010652785
        0.743622815930869	0.828173019656857	0.513760998087872
        0.743176186199670	0.824862607498216	0.509504985522959
        0.742729556468470	0.821552195339576	0.505248972958047
        0.742282926737271	0.818241783180935	0.500992960393134
        0.741190775062545	0.814265910351716	0.496014754191482
        0.739935200110978	0.810121566466654	0.490853714157744
        0.738667879111388	0.805965113724454	0.485679532942324
        0.737361745083548	0.801768649106490	0.480461928691784
        0.736055611055707	0.797572184488527	0.475244324441245
        0.734734018624373	0.793358446812886	0.470011513204585
        0.733404696991291	0.789136072608405	0.464771098474865
        0.731998083340738	0.784827333115533	0.459454648814545
        0.729903570734691	0.779749942555980	0.453461488271884
        0.727809058128644	0.774672551996427	0.447468327729222
        0.725714545522596	0.769595161436874	0.441475167186561
        0.723620032916549	0.764517770877320	0.435482006643900
        0.721525520310501	0.759440380317767	0.429488846101238
        0.719365085114883	0.754282136749124	0.423445128051527
        0.717202589838340	0.749121366523946	0.417399830079719
        0.714834086469388	0.743707930645359	0.411196539898379
        0.712161721164131	0.737921812927996	0.404760211207978
        0.709489355858875	0.732135695210634	0.398323882517577
        0.706816990553618	0.726349577493270	0.391887553827176
        0.704144625248362	0.720563459775908	0.385451225136775
        0.701442907240360	0.714737743713244	0.379001955709668
        0.698662915358372	0.708806432063113	0.372518177651346
        0.695882923476384	0.702875120412982	0.366034399593024
        0.692809404566947	0.696547825309846	0.359421214167642
        0.689614281603280	0.690056479919037	0.352754417118765
        0.686419158639614	0.683565134528229	0.346087620069887
        0.683224035675948	0.677073789137420	0.339420823021010
        0.680028912712282	0.670582443746612	0.332754025972133
        0.676761909529127	0.663985281216969	0.326089741175275
        0.673441941973718	0.657310148163976	0.319427307511483
        0.670118947882752	0.650630559652506	0.312764979626724
        0.666499353307161	0.643514336210270	0.306113018087138
        0.662879758731570	0.636398112768034	0.299461056547552
        0.659260164155979	0.629281889325798	0.292809095007966
        0.655640569580388	0.622165665883562	0.286157133468379
        0.652020975004797	0.615049442441326	0.279505171928793
        0.648293209045136	0.607766250434623	0.272918175168083
        0.644550522894569	0.600460028281096	0.266340139066528
        0.640745573639644	0.593057699553327	0.259799496484910
        0.636804047252577	0.585444556404639	0.253340878398637
        0.632862520865510	0.577831413255951	0.246882260312364
        0.628920994478444	0.570218270107262	0.240423642226091
        0.624979468091378	0.562605126958574	0.233965024139818
        0.621010382915392	0.554950575583765	0.227538261781844
        0.616917283189268	0.547109687191412	0.221254850201220
        0.612824183463145	0.539268798799060	0.214971438620595
        0.608626015854266	0.531270041544622	0.208809477004113
        0.604362396121704	0.523172939753148	0.202723172742343
        0.600098776389142	0.515075837961674	0.196636868480573
        0.595835156656579	0.506978736170200	0.190550564218803
        0.591571536924017	0.498881634378725	0.184464259957033
        0.587232604837201	0.490684218416950	0.178497511691802
        0.582813653373991	0.482380218649231	0.172657791672895
        0.578394701910781	0.474076218881511	0.166818071653988
        0.573863029654197	0.465622077839164	0.161157292353585
        0.569321447877318	0.457154737563882	0.155512244105359
        0.564779866100438	0.448687397288600	0.149867195857133
        0.560238284323559	0.440220057013318	0.144222147608906
        0.555696702546679	0.431752716738036	0.138577099360680
        0.551032159977083	0.423153855746282	0.133162738608827
        0.546334512578679	0.414519585330862	0.127810486029073
        0.541617948135242	0.405865080959061	0.122493723833377
        0.536835174034188	0.397139757739928	0.117301177981882
        0.532052399933135	0.388414434520796	0.112108632130387
        0.527269625832081	0.379689111301664	0.106916086278891
        0.522486851731028	0.370963788082531	0.101723540427396
        0.517688093497898	0.362227958515399	0.0965674253950828
        0.512729493944013	0.353387065468277	0.0917756185545907
        0.507770894390128	0.344546172421154	0.0869838117140987
        0.502779047841526	0.335683426170194	0.0822677809775055
        0.497757151124621	0.326800927984994	0.0776202401809744
        0.492735254407717	0.317918429799795	0.0729726993844435
        0.487713357690813	0.309035931614596	0.0683251585879127
        0.482691460973908	0.300153433429397	0.0636776177913818
        0.477624656739577	0.291280073405378	0.0591864564244044
        0.472488764016894	0.282420772090867	0.0549358787952013
        0.467352871294212	0.273561470776356	0.0506853011659983
        0.462196745514227	0.264706286655343	0.0465051802028579
        0.457036425076021	0.255851956098837	0.0423396661095109
        0.451876104637815	0.246997625542331	0.0381741520161638
        0.446715784199609	0.238143294985824	0.0340086379228168
        0.441555463761403	0.229288964429318	0.0298431238294698
        0.436371929545775	0.220566114409224	0.0259737138995730
        0.431178302383441	0.211900429839743	0.0222330449103065
        0.425984251968504	0.203237142531096	0.0184977747346796
        0.420787401574803	0.194589714024877	0.0147982197877437
        0.415590551181102	0.185942285518658	0.0110986648408079
        0.410393700787401	0.177294857012438	0.00739910989387184
        0.405196850393701	0.168647428506219	0.00369955494693592
        0.400000000000000	0.160000000000000	0];
 
    if(~isnumeric( ppcolor))
        if (ppcolor=="NDVI")
            colormap(ndvi_colormap);
        end
    else
        colormap(ppcolor);
    end

    %%dibujar mapa ndvi proyeccion mercator 
    m_proj('mercator','lon',lon_map,'lat',lat_map);
      
    %%dibujar el mapa
    m_pcolor(lon,lat,data); shading interp ;
  
    if plabel ~= ""    
        colorbar('eastoutside');
        c = colorbar;
        c.Label.String = plabel;
    end

    if length (pclim) == 2
       clim(pclim);
    end 
    
    %dibuja el recuadro del mapa
    %m_grid('box','fancy','grid','none','fontsize',10);
    m_grid('linestyle','none','box','fancy','tickdir','out');
    %m_grid('linewi',2,'tickdir','out');

    % Regla de escala
    m_ruler([.05 .36],.1,3,'fontsize',7)
    
    % colocar estrella en posición correcta
    
    %m_northarrow(-101,23.5,.4,'type',2);
    % Estrella del norte 
    %m_northarrow(-97.9,23.5,.4,'type',2);

    if(~isempty (ptitle))
        title(ptitle);
    end
end